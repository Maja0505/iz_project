%Configuration_Environment_Manipulation
attack(Supply_Chain,_Configuration_Environment_Manipulation).
parentOf(Configuration_Environment_Manipulation,Manipulating_Writeable_Configuration_Files).
parentOf(Configuration_Environment_Manipulation,Manipulate_Registry_Information).
parentOf(Configuration_Environment_Manipulation,Schema_Poisoning).
parentOf(Configuration_Environment_Manipulation,Data_Injected_During_Configuration).
parentOf(Configuration_Environment_Manipulation,Disable_Security_Software).
prerequisites(Configuration_Environment_Manipulation,The_target_application_must_consult_external_files_or_configuration_controls_to_control_its_execution).
related_weaknesses(Configuration_Environment_Manipulation,External_Control_of_System_or_Configuration_Setting).
related_weaknesses(Configuration_Environment_Manipulation,Improper_Hardware_Lock_Protection_for_Security_Sensitive_Controls).
related_weaknesses(Configuration_Environment_Manipulation,Hardware_Internal_or_Debug_Modes_Allow_Override_of_Locks).

%Manipulating_Writeable_Configuration_Files
attack(Configuration_Environment_Manipulation,Manipulating_Writeable_Configuration_Files).
prerequisites(Manipulating_Writeable_Configuration_Files,Configuration_files_must_be_modifiable_by_the_attacker).
related_weaknesses(Manipulating_Writeable_Configuration_Files,Acceptance_of_Extraneous_Untrusted_Data_With_Trusted_Data).
related_weaknesses(Manipulating_Writeable_Configuration_Files,Improper_Control_of_Resource_Identifiers).
related_weaknesses(Manipulating_Writeable_Configuration_Files,Improper_Neutralization_of_Special_Elements_used_in_a_Command).
related_weaknesses(Manipulating_Writeable_Configuration_Files,Origin_Validation_Error).
related_weaknesses(Manipulating_Writeable_Configuration_Files,Missing_Support_for_Integrity_Check).
related_weaknesses(Manipulating_Writeable_Configuration_Files,Improper_Validation_of_Integrity_Check_Value).
related_weaknesses(Manipulating_Writeable_Configuration_Files,OWASP_Top_Ten_2007_Category_A2_Injection_Flaws).
prerequisites(Manipulating_Writeable_Configuration_Files,_Configuration_files_must_be_modifiable_by_the_attacker).
mitigations(Manipulating_Writeable_Configuration_Files,Design,Enforce_principle_of_least_privilege).
mitigations(Manipulating_Writeable_Configuration_Files,Design,Backup_copies_of_all_configuration_files).
mitigations(Manipulating_Writeable_Configuration_Files,Implementation,Integrity_monitoring_for_configuration_files_).
mitigations(Manipulating_Writeable_Configuration_Files,Implementation,Enforce_audit_logging_on_code_and_configuration_promotion_procedures).
mitigations(Manipulating_Writeable_Configuration_Files,Implementation,Load_configuration_from_separate_process_and_memory_space_for_example_a_separate_physical_device_like_a_CD).

%Manipulate_Registry_Information
attack(Configuration_Environment_Manipulation,Manipulate_Registry_Information).
parentOf(Manipulate_Registry_Information,Poison_Web_Service_Registry).
parentOf(Manipulate_Registry_Information,Modification_of_Registry_Run_Keys).
parentOf(Manipulate_Registry_Information,Modification_of_Windows_Service_Configuration).
prerequisites(Manipulate_Registry_Information,The_targeted_application_must_rely_on_values_stored_in_a_registry).
prerequisites(Manipulate_Registry_Information,The_adversary_must_have_a_means_of_elevating_permissions_in_order_to_access_and_modify_registry_content_through_either_administrator_privileges_or_a_remote_access_tool_capable_of_editing_a_registry_through_an_API).
related_weaknesses(Manipulate_Registry_Information,External_Control_of_System_or_Configuration_Setting).
mitigations(Manipulate_Registry_Information,Ensure_proper_permissions_are_set_for_Registry_hives_to_prevent_users_from_modifying_keys).
mitigations(Manipulate_Registry_Information,Employ_a_robust_and_layered_defensive_posture_in_order_to_prevent_unauthorized_users_on_your_system).
mitigations(Manipulate_Registry_Information,Employ_robust_identification_and_audit_blocking_using_an_allowlist_of_applications_on_your_system).


%Poison_Web_Service_Registry
attack(Manipulate_Registry_Information,Poison_Web_Service_Registry).
prerequisites(Poison_Web_Service_Registry,The_attacker_must_be_able_to_write_to_resources_or_redirect_access_to_the_service_registry).
related_weaknesses(Poison_Web_Service_Registry,Improper_Authorization).
related_weaknesses(Poison_Web_Service_Registry,Improper_Neutralization_of_Special_Elements_in_Output_Used_by_a_Downstream_Component).
related_weaknesses(Poison_Web_Service_Registry,Protection_Mechanism_Failure).
mitigations(Poison_Web_Service_Registry,Design,Enforce_principle_of_least_privilege).
mitigations(Poison_Web_Service_Registry,Design,Harden_registry_server_and_file_access_permissions).
mitigations(Poison_Web_Service_Registry,Implementation,Implement_communications_to_and_from_the_registry_using_secure_protocols).

%Modification_of_Registry_Run_Keys
attack(Manipulate_Registry_Information,Modification_of_Registry_Run_Keys).
prerequisites(Modification_of_Registry_Run_Keys,The_adversary_must_have_gained_access_to_the_target_system_via_physical_or_logical_means_in_order_to_carry_out_this_attack).
related_weaknesses(Modification_of_Registry_Run_Keys,External_Control_of_System_or_Configuration_Setting).
mitigations(Modification_of_Registry_Run_Keys,Identify_programs_that_may_be_used_to_acquire_process_information_and_block_them_by_using_a_software_restriction_policy_or_tools_that_restrict_program_execution_by_using_a_process_allowlist).


%Modification_of_Windows_Service_Configuration
attack(Manipulate_Registry_Information,Modification_of_Windows_Service_Configuration).
prerequisites(Modification_of_Windows_Service_Configuration,The_adversary_must_have_the_capability_to_write_to_the_Windows_Registry_on_the_targeted_system).
related_weaknesses(Modification_of_Windows_Service_Configuration,Improper_Access_Control).
mitigations(Modification_of_Windows_Service_Configuration,Ensure_proper_permissions_are_set_for_Registry_hives_to_prevent_users_from_modifying_keys_for_system_components_that_may_lead_to_privilege_escalation).
